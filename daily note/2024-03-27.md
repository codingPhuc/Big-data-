```
what is K mean  : 
K mean  : 
is the most basic 
data is represented in Euclidean space/distince data is a vector 
- used Euclidean distince 


in Euclidean how do we represent a clustor ?: 
- cetroid of a clustor  (centroid is calculated by average of all point in the clustor  ) (is a fake point )
- distince of two clustor is the distince of the centroid 


K mean algorithm  : 
- initialize k centroid (illusionaly k centroid ) 
- how can we find the inital k centroid  ? 
	- it recomended that we should choose centroid that have a smallest
- in N number of point choose a random centroid  
	- loop until hội tụ thì ngừng 
		- hội tụ (convergence): khi các centroid di chuyen khong đáng ke so voi lan lặp lan truoc do 
- duyệt qua từng điểm dữ liệu gan no vao clustor co centroid gần no nhat 
- sau khi gan tien thanh cap nhap centroid    

K mean phù hop voi du  lieu ma cac clustor co dạng lồi (canvas)


How do we choose the K in k mean ? 

de danh gia cac khoang phan cung  ta phai giua vao  gia trung binh cua khoang cach cach cac diem du lieu den centroid cua no 
```

**K-Means Clustering:** K-Means is a basic algorithm used in machine learning for cluster analysis. In this method, data is represented as vectors in Euclidean space, and the Euclidean distance is used to measure the distance between data points.

**Representation of a Cluster in Euclidean Space:**

- A cluster is represented by its centroid, which is a virtual or ‘fake’ point calculated by taking the average of all points in the cluster.
- The distance between two clusters is determined by the distance between their centroids.

**K-Means Algorithm:**

- Initialize k centroids (these are illusionary or ‘fake’ centroids).
	- To find the initial k centroids, it is recommended to choose centroids that have the smallest Euclidean distance to the other points.
- For a given number of points N, choose a random centroid.
- Repeat the following steps until convergence (hội tụ) (i.e., when the centroids move insignificantly compared to the previous iteration):
    - For each data point, assign it to the cluster whose centroid is nearest.
    - After assignment, update the centroids.

K-Means is suitable for data where the clusters are convex in shape.

**Choosing K in K-Means:** To evaluate the quality of the clustering, we look at the average distance of the data points to their respective centroids. This helps in determining the optimal number of clusters (k). 

![[7-picture1.jpg]]
- the chart show that the number 
-  $avg  = \frac{1}{N} *\sum^{N}_{i}{d(X_i , C_i)}$ 





```
## BFr 
mot phien ban nang cao cua k min   danh cho truong hop du lieu lon   , có cluster dạng lồi 
hon k min xu ly du lieu lon  
requirement input : 
- bieu dien du lieu trong khong gian euclidean  space 
- trong khong gian euclidean bieu dien clustor bang centroid 
- do khoang cach bang khoang cach 2 centroid  



## BFG algorithm 
centroid không thể dc tao ra bằng cách cộng trung bình 
1. khoi tao k centroid phân biệt 
2.  load vào 1 lô(batch) dữ liệu 
- voi lô du lieu vua load , gán các điểm dữ liệu vào clustor có centroid gần nó nhất but  đảm bảo khoảng cách giữa điểm dữ liệu và centroid không vượt quá ngững S cho trước (đủ gần ) 
- với các điểm dữ liệu không đủ gần , tiến thành phân cụng và tạo ra các clustor mới 
- gộp các clustor mới tạo ra ở bước 4  với các clustor có từ  ban đầu nếu đủ gần, nếu đủ gần 
- lặp lại bước 2 dến 5 đến khi nào hết tập dữ liệu thì ngừng  

Step 1 :   
load lô dữ liệu đầu tiên khởi tạo k centroid  : 
apporch 1  :  take k rando points 
appoarch 2 :  tiến thành phân cụng để có k  centroid  
appoarch 3  : lần lược chọn các điểm dữ liệu sao cho điểm dữ liệu chọn sau càng xa điểm chọn trước càng tốt 



Step  2 : 
load batch dữ liệu tiếp theo  

Step 3 : 

với lô giữ liệu vừa load gán  , thêm chúng vào tập ds  

Step4 : 
với các điểm dữ liệu không dủ gần tiến thành phân cụng bằng thuật toán in memory  
điểm cho vào clustor mới thì vào CS , điểm thuộc outliner thì vào RS 

Step 5 
với các điểm giữ liệu trong DS 
- cập nhập clustor Add N , sum , SUMSQ
- xem xét gộp các clustor mới tạo ra  vào cluster có từ ban đầu  

gộp tất cả các clustor mới và các điểm outlier vào clustor gần nhất 
```



**BFR (Bradley-Fayyad-Reina) Algorithm:** BFR is an advanced version of the K-Means algorithm designed for large datasets and convex clusters. It is more efficient than K-Means for handling large data.

**Input Requirements:**

- Data is represented in Euclidean space.
- In Euclidean space, a cluster is represented by its centroid.
- The distance is measured by the distance between two centroids.

**BFG Algorithm:** Centroids cannot be created by averaging. The steps of the algorithm are as follows:

1. Initialize k distinct centroids.
2. Load a batch of data.
    - For the loaded batch of data, assign the data points to the cluster with the nearest centroid, ensuring that the distance between the data point and the centroid does not exceed a predefined threshold S (close enough).
    - For data points that are not close enough, perform clustering and create new clusters.
    - Merge the newly created clusters from step 4 with the original clusters if they are close enough.
    - Repeat steps 2 to 5 until all data has been processed.

**Step 1:** Load the first batch of data and initialize k centroids. There are several approaches:

- Approach 1: Take k random points.
- Approach 2: Perform clustering to get k centroids.
- Approach 3: Sequentially select data points such that each subsequent point chosen is as far away as possible from the previous point.

**Step 2:** Load the next batch of data.

**Step 3:** With the newly loaded batch of data, add them to the dataset DS if those point are closest in the cluster. 

**Step 4:** For data points that are not close enough, perform in-memory clustering. Points that go into a new cluster go into CS, points that are outliers go into RS.

**Step 5:** For the data points in DS:

- Update the cluster: Add N, sum, SUMSQ.
- Consider merging the newly created clusters with the original clusters.

Merge all new clusters and outlier points into the nearest cluster.

```

summarizing : 
- cần lưu trữ thông tin  n số lượng điểm dữ liệu 
- sum tông các điểm 
- SUMSQ : tổng bình phương của các điểm 
	- avg   =  $\frac{1}{N} *\sum^{N}_{i}{d(X_i , C_i)^2}$ 
the resone  why this math is needed 
centroid = $\frac{sum}{n}$ 
variance  =  $\frac{SumSQ}{n} - (\frac{sum}{n})^2$ = $E [x^2] -(E [x]) ^2$=avg   =  $\frac{1}{N} *\sum_{}(X_i - X)^2$ 



trong mỗi bước lặp của thuật toán BFG sẽ có 3 cái tập hợp dc tạo ra 
DS : chứa các điêm dữ liệu đủ gần để gán vào các cái clustor hiện có  
,CS : Tiến thành phân cụm 
- với các điểm dữ liệu không đủ gần tiến thành phân cụm để tạo ra các clustor mới 
- điểm dữ liệu nào mà thuộc vào các clustor mới tạo ra thì thêm vào CS 
- các điểm dữ liệu outlier đựa vô RS 
, RS 


DS các điểm clustor ban đầu 
CS cac điểm k gần clutor ban đầu
RS điểm riêng biệt 
```


**Summary:**

- It’s necessary to store information about the number of data points (N), the sum of the data points, and the sum of squares (SUMSQ) of the data points.
- The average is calculated as
    
    $$\frac{1}{N} \sum^{N}_{i}{d(X_i , C_i)^2}N1​i∑N​d(Xi​,Ci​)2$$
    

The reason why this math is needed:

- The centroid is calculated as
    
    $$\frac{sum}{n}​$$
    
- The variance is calculated as
    
    $$\frac{SumSQ}{n} - (\frac{sum}{n})^2 = E [x^2] -(E [x]) ^2 = avg = \frac{1}{N} \sum{}(X_i - X)^2nSumSQ​−(nsum​)2=E[x2]−(E[x])2=avg=N1​∑(Xi​−X)2$$
    

In each iteration of the BFG algorithm, three sets are created:

1. **DS (Discard Set)**: Contains data points that are close enough to be assigned to the existing clusters.
2. **CS (Compression Set)**: Performs clustering.
    - For data points that are not close enough, clustering is performed to create new clusters.
    - Data points that belong to the newly created clusters are added to CS.
    - Outlier data points are added to RS.
3. **RS (Retained Set)**: Contains outlier data points.

DS contains the original cluster points, CS contains points that are close to the original cluster, and RS contains distinct points.

```
# Cure  (Clustering Using  RePresentation)
là phiên bảng mở rộng của k min có thể xử lý cluster với hình dạng bất kỳ 
không yêu cầu hình dạng clustor  
không xử dụng centroid  , biểu diễn cluster bằng tập hợp các điêm đại diện  

thuật toán cure có hai pass  
- load 1 phần nhỏ dữ liệu  xử lý bằng    phân cụm  phân cấp in memory  
- chọn các điểm đại diện cho từng cluster  , càng xa nhau càng tốt  , di chuyển các điểm đại diện hướng vào tâm clustor  , gộp các clustor có điểm đại diện gần nhau  
- 
pass 2 : 
- duyệt qua tập dữ lieu 1 lần nữa ,  gán mỗi diễm dư liệu vào cluster có điểm đại diện gần nó nhất 
- 
```

**CURE (Clustering Using REpresentatives):** CURE is an extension of the K-Means algorithm that can handle clusters of any shape. It does not require clusters to be of a specific shape and does not use centroids. Instead, clusters are represented by a set of representative points.

The CURE algorithm has two passes:

**Pass 1:**

- Load a small portion of the data and process it using in-memory hierarchical clustering.
- Choose representative points for each cluster. The more distant these points are from each other, the better. Move the representative points towards the center of the cluster and merge clusters that have close representative points.

**Pass 2:**

- Traverse the dataset again, assigning each data point to the cluster whose representative point is nearest to it.


![[7-picture2.jpg]]